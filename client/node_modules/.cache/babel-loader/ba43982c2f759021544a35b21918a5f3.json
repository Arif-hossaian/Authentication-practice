{"ast":null,"code":"var _jsxFileName = \"E:\\\\mern-auth\\\\client\\\\src\\\\components\\\\body\\\\profile\\\\Profile.jsx\",\n    _s = $RefreshSig$();\n\nimport { Container, Grid, Paper, Grow, Card, CardContent, Button, TableContainer, Table, TableHead, TableRow, TableCell, TableBody } from \"@material-ui/core\";\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { isLength, isMatch } from \"../../utils/validation/Validation.js\";\nimport { showErrMsg, showSuccessMsg } from \"../../utils/notification/Notification.js\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCamera } from \"@fortawesome/free-solid-svg-icons\";\nimport classes from \"./profile.module.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  name: \"\",\n  password: \"\",\n  cf_password: \"\",\n  err: \"\",\n  success: \"\"\n};\n\nconst Profile = () => {\n  _s();\n\n  const auth = useSelector(state => state.auth);\n  const token = useSelector(state => state.token);\n  const users = useSelector(state => state.users);\n  const {\n    user,\n    isAdmin\n  } = auth;\n  const [data, setData] = useState(initialState);\n  const {\n    name,\n    password,\n    cf_password,\n    err,\n    success\n  } = data;\n  const [avatar, setAvatar] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [callback, setCallback] = useState(false);\n  const dispatch = useDispatch();\n\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setData({ ...data,\n      [name]: value,\n      err: \"\",\n      success: \"\"\n    });\n  }; //Change Avatar\n\n\n  const changeAvatar = async e => {\n    e.preventDefault();\n\n    try {\n      const file = e.target.files[0];\n      if (!file) return setData({ ...data,\n        err: \"No files were uploaded.\",\n        success: ''\n      });\n      if (file.size > 1024 * 1024) return setData({ ...data,\n        err: \"Size too large.\",\n        success: ''\n      });\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png') return setData({ ...data,\n        err: \"File format is incorrect.\",\n        success: ''\n      });\n      let formData = new FormData();\n      formData.append('file', file);\n      setLoading(true);\n      const res = await axios.post('/api/upload_avatar', formData, {\n        headers: {\n          'content-type': 'multipart/form-data',\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setAvatar(res.data.url);\n    } catch (err) {\n      setData({ ...data,\n        err: err.response.data.msg,\n        success: ''\n      });\n    }\n  }; //Update user Information\n\n\n  const updateInfor = () => {\n    try {\n      axios.patch(\"/user/update\", {\n        name: name ? name : user.name,\n        avatar: avatar ? avatar : user.avatar\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setData({ ...data,\n        err: \"\",\n        success: \"Updated Success!\"\n      });\n    } catch (err) {\n      setData({ ...data,\n        err: err.response.data.msg,\n        success: \"\"\n      });\n    }\n  }; //Update User-password\n\n\n  const updatePassword = () => {\n    if (isLength(password)) return setData({ ...data,\n      err: \"Password must be at least 6 characters.\",\n      success: \"\"\n    });\n    if (!isMatch(password, cf_password)) return setData({ ...data,\n      err: \"Password did not match.\",\n      success: \"\"\n    });\n\n    try {\n      axios.post(\"/user/reset\", {\n        password\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setData({ ...data,\n        err: \"\",\n        success: \"Updated Success!\"\n      });\n    } catch (err) {\n      setData({ ...data,\n        err: err.response.data.msg,\n        success: \"\"\n      });\n    }\n  }; //Update on Button-Click\n\n\n  const handleUpdate = () => {\n    if (name || avatar) updateInfor();\n    if (password) updatePassword();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [err && showErrMsg(err), success && showSuccessMsg(success), loading && /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Loading.....\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grow, {\n      in: true,\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(CardContent, {\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              spacing: 3,\n              children: [/*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                md: 4,\n                xs: 12,\n                className: classes.left_grid,\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  style: {\n                    textAlign: \"center\"\n                  },\n                  children: isAdmin ? \"Admin profile\" : \"User profile\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: classes.avatar,\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: avatar ? avatar : user.avatar,\n                    alt: \"\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 157,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      children: \"Change\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 160,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"file\",\n                      name: \"file\",\n                      id: \"file_up\",\n                      onChange: changeAvatar\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 161,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 158,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"name\",\n                    children: \"Name\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"text\",\n                    name: \"name\",\n                    id: \"name\",\n                    defaultValue: user.name,\n                    onChange: handleChange,\n                    placeholder: \"Your name\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 166,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"email\",\n                    children: \"Email\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 176,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"email\",\n                    name: \"email\",\n                    id: \"email\",\n                    defaultValue: user.email,\n                    placeholder: \"Your email address\",\n                    disabled: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 177,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"password\",\n                    children: \"New Password\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 188,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"password\",\n                    name: \"password\",\n                    id: \"password\",\n                    placeholder: \"Your password\",\n                    value: password,\n                    onChange: handleChange\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 189,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"cf_password\",\n                    children: \"Confirm New Password\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 200,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"password\",\n                    name: \"cf_password\",\n                    id: \"cf_password\",\n                    placeholder: \"Confirm password\",\n                    value: cf_password,\n                    onChange: handleChange\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 201,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 199,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: /*#__PURE__*/_jsxDEV(\"em\", {\n                    style: {\n                      color: \"crimson\"\n                    },\n                    children: \"* If you update your password here, you will not be able to login quickly using google and facebook.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 212,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginTop: \"18px\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"contained\",\n                    color: \"primary\",\n                    disabled: loading,\n                    size: \"large\",\n                    onClick: handleUpdate,\n                    children: \"Update\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 218,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                md: 8,\n                sm: 12,\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  style: {\n                    textAlign: \"center\"\n                  },\n                  children: isAdmin ? \"Users\" : \"My Orders\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 230,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: /*#__PURE__*/_jsxDEV(TableContainer, {\n                    children: /*#__PURE__*/_jsxDEV(Table, {\n                      children: [/*#__PURE__*/_jsxDEV(TableHead, {\n                        children: /*#__PURE__*/_jsxDEV(TableRow, {\n                          children: /*#__PURE__*/_jsxDEV(TableCell, {}, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 238,\n                            columnNumber: 29\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 237,\n                          columnNumber: 27\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 236,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(TableBody, {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 241,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 235,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 234,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Profile, \"Njb+GAqZhdBdQQo/0Fv77sIUdN4=\", false, function () {\n  return [useSelector, useSelector, useSelector, useDispatch];\n});\n\n_c = Profile;\nexport default Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["E:/mern-auth/client/src/components/body/profile/Profile.jsx"],"names":["Container","Grid","Paper","Grow","Card","CardContent","Button","TableContainer","Table","TableHead","TableRow","TableCell","TableBody","React","useState","useEffect","axios","useSelector","useDispatch","Link","isLength","isMatch","showErrMsg","showSuccessMsg","FontAwesomeIcon","faCamera","classes","initialState","name","password","cf_password","err","success","Profile","auth","state","token","users","user","isAdmin","data","setData","avatar","setAvatar","loading","setLoading","callback","setCallback","dispatch","handleChange","e","value","target","changeAvatar","preventDefault","file","files","size","type","formData","FormData","append","res","post","headers","Authorization","url","response","msg","updateInfor","patch","updatePassword","handleUpdate","left_grid","textAlign","email","color","marginTop"],"mappings":"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","sourcesContent":["import {\r\n  Container,\r\n  Grid,\r\n  Paper,\r\n  Grow,\r\n  Card,\r\n  CardContent,\r\n  Button,\r\n  TableContainer,\r\n  Table,\r\n  TableHead,\r\n  TableRow,\r\n  TableCell,\r\n  TableBody,\r\n} from \"@material-ui/core\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { isLength, isMatch } from \"../../utils/validation/Validation.js\";\r\nimport {\r\n  showErrMsg,\r\n  showSuccessMsg,\r\n} from \"../../utils/notification/Notification.js\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faCamera } from \"@fortawesome/free-solid-svg-icons\";\r\nimport classes from \"./profile.module.css\";\r\n\r\nconst initialState = {\r\n  name: \"\",\r\n  password: \"\",\r\n  cf_password: \"\",\r\n  err: \"\",\r\n  success: \"\",\r\n};\r\nconst Profile = () => {\r\n  const auth = useSelector((state) => state.auth);\r\n  const token = useSelector((state) => state.token);\r\n\r\n  const users = useSelector((state) => state.users);\r\n\r\n  const { user, isAdmin } = auth;\r\n  const [data, setData] = useState(initialState);\r\n  const { name, password, cf_password, err, success } = data;\r\n\r\n  const [avatar, setAvatar] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [callback, setCallback] = useState(false);\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setData({ ...data, [name]: value, err: \"\", success: \"\" });\r\n  };\r\n\r\n  //Change Avatar\r\n  const changeAvatar = async(e) => {\r\n    e.preventDefault()\r\n    try {\r\n        const file = e.target.files[0]\r\n\r\n        if(!file) return setData({...data, err: \"No files were uploaded.\" , success: ''})\r\n\r\n        if(file.size > 1024 * 1024)\r\n            return setData({...data, err: \"Size too large.\" , success: ''})\r\n\r\n        if(file.type !== 'image/jpeg' && file.type !== 'image/png')\r\n            return setData({...data, err: \"File format is incorrect.\" , success: ''})\r\n\r\n        let formData =  new FormData()\r\n        formData.append('file', file)\r\n\r\n        setLoading(true)\r\n        const res = await axios.post('/api/upload_avatar', formData, {\r\n            headers: {'content-type': 'multipart/form-data', Authorization: token}\r\n        })\r\n\r\n        setLoading(false)\r\n        setAvatar(res.data.url)\r\n        \r\n    } catch (err) {\r\n        setData({...data, err: err.response.data.msg , success: ''})\r\n    }\r\n}\r\n\r\n\r\n  //Update user Information\r\n  const updateInfor = () => {\r\n    try {\r\n      axios.patch(\r\n        \"/user/update\",\r\n        {\r\n          name: name ? name : user.name,\r\n          avatar: avatar ? avatar : user.avatar,\r\n        },\r\n        {\r\n          headers: { Authorization: token },\r\n        }\r\n      );\r\n\r\n      setData({ ...data, err: \"\", success: \"Updated Success!\" });\r\n    } catch (err) {\r\n      setData({ ...data, err: err.response.data.msg, success: \"\" });\r\n    }\r\n  };\r\n\r\n  //Update User-password\r\n  const updatePassword = () => {\r\n    if (isLength(password))\r\n      return setData({\r\n        ...data,\r\n        err: \"Password must be at least 6 characters.\",\r\n        success: \"\",\r\n      });\r\n\r\n    if (!isMatch(password, cf_password))\r\n      return setData({ ...data, err: \"Password did not match.\", success: \"\" });\r\n\r\n    try {\r\n      axios.post(\r\n        \"/user/reset\",\r\n        { password },\r\n        {\r\n          headers: { Authorization: token },\r\n        }\r\n      );\r\n\r\n      setData({ ...data, err: \"\", success: \"Updated Success!\" });\r\n    } catch (err) {\r\n      setData({ ...data, err: err.response.data.msg, success: \"\" });\r\n    }\r\n  };\r\n\r\n  //Update on Button-Click\r\n  const handleUpdate = () => {\r\n    if (name || avatar) updateInfor();\r\n    if (password) updatePassword();\r\n  };\r\n  return (\r\n    <>\r\n      <div>\r\n        {err && showErrMsg(err)}\r\n        {success && showSuccessMsg(success)}\r\n        {loading && <h3>Loading.....</h3>}\r\n      </div>\r\n      <Grow in>\r\n        <Container>\r\n          <Card>\r\n            <CardContent>\r\n              <Grid container spacing={3}>\r\n                <Grid item md={4} xs={12} className={classes.left_grid}>\r\n                  <h2 style={{ textAlign: \"center\" }}>\r\n                    {isAdmin ? \"Admin profile\" : \"User profile\"}\r\n                  </h2>\r\n                  <div className={classes.avatar}>\r\n                    <img src={avatar ? avatar : user.avatar} alt=\"\" />\r\n                    <span>\r\n                      {/* <FontAwesomeIcon icon={faCamera} /> */}\r\n                      <p >Change</p>\r\n                      <input type=\"file\" name=\"file\" id=\"file_up\" onChange={changeAvatar}/>\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"name\">Name</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      name=\"name\"\r\n                      id=\"name\"\r\n                      defaultValue={user.name}\r\n                      onChange={handleChange}\r\n                      placeholder=\"Your name\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"email\">Email</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      name=\"email\"\r\n                      id=\"email\"\r\n                      defaultValue={user.email}\r\n                      placeholder=\"Your email address\"\r\n                      disabled\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"password\">New Password</label>\r\n                    <input\r\n                      type=\"password\"\r\n                      name=\"password\"\r\n                      id=\"password\"\r\n                      placeholder=\"Your password\"\r\n                      value={password}\r\n                      onChange={handleChange}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"cf_password\">Confirm New Password</label>\r\n                    <input\r\n                      type=\"password\"\r\n                      name=\"cf_password\"\r\n                      id=\"cf_password\"\r\n                      placeholder=\"Confirm password\"\r\n                      value={cf_password}\r\n                      onChange={handleChange}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <em style={{ color: \"crimson\" }}>\r\n                      * If you update your password here, you will not be able\r\n                      to login quickly using google and facebook.\r\n                    </em>\r\n                  </div>\r\n                  <div style={{ marginTop: \"18px\" }}>\r\n                    <Button\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      disabled={loading}\r\n                      size=\"large\"\r\n                      onClick={handleUpdate}\r\n                    >\r\n                      Update\r\n                    </Button>\r\n                  </div>\r\n                </Grid>\r\n                <Grid item md={8} sm={12}>\r\n                  <h2 style={{ textAlign: \"center\" }}>\r\n                    {isAdmin ? \"Users\" : \"My Orders\"}\r\n                  </h2>\r\n                  <div>\r\n                    <TableContainer>\r\n                      <Table>\r\n                        <TableHead>\r\n                          <TableRow>\r\n                            <TableCell></TableCell>\r\n                          </TableRow>\r\n                        </TableHead>\r\n                        <TableBody></TableBody>\r\n                      </Table>\r\n                    </TableContainer>\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            </CardContent>\r\n          </Card>\r\n        </Container>\r\n      </Grow>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n"]},"metadata":{},"sourceType":"module"}